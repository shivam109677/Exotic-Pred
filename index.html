<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Crop Predictor</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Inter Font -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6; /* Light gray background */
        }
        .container {
            max-width: 900px;
            margin: 2rem auto;
            padding: 1.5rem;
            background-color: #ffffff;
            border-radius: 1rem;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.08), 0 6px 6px rgba(0, 0, 0, 0.12);
        }
        input, select {
            border: 1px solid #d1d5db; /* Light gray border */
            border-radius: 0.5rem;
            padding: 0.75rem 1rem;
            width: 100%;
            transition: border-color 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
        }
        input:focus, select:focus {
            border-color: #6366f1; /* Indigo focus color */
            outline: none;
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.2); /* Light indigo shadow */
        }
        button {
            padding: 0.75rem 1.5rem;
            background-color: #4f46e5; /* Indigo */
            color: white;
            border-radius: 0.5rem;
            font-weight: 600;
            transition: background-color 0.3s ease-in-out, transform 0.1s ease-in-out;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        button:hover {
            background-color: #4338ca; /* Darker indigo on hover */
            transform: translateY(-2px);
        }
        button:active {
            transform: translateY(0);
        }
        .result-card {
            background-color: #f9fafb; /* Lighter background for result cards */
            border-radius: 0.75rem;
            padding: 1rem;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
            margin-top: 1rem;
            border: 1px solid #e5e7eb; /* Subtle border */
        }
    </style>
</head>
<body class="p-4 sm:p-6 md:p-8">
    <div class="container">
        <h1 class="text-3xl sm:text-4xl font-bold text-center text-gray-800 mb-6">Crop Prediction & Suggestion</h1>
        <p class="text-center text-gray-600 mb-8">Enter your details to get traditional crop predictions and exotic crop suggestions.</p>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
            <div>
                <label for="month" class="block text-gray-700 text-sm font-semibold mb-2">Month (1-12)</label>
                <input type="number" id="month" min="1" max="12" value="6" class="shadow-sm focus:ring-indigo-500 focus:border-indigo-500 block w-full sm:text-sm border-gray-300 rounded-md">
            </div>
            <div>
                <label for="season" class="block text-gray-700 text-sm font-semibold mb-2">Season</label>
                <select id="season" class="shadow-sm focus:ring-indigo-500 focus:border-indigo-500 block w-full sm:text-sm border-gray-300 rounded-md">
                    <option value="Kharif">Kharif</option>
                    <option value="Rabi">Rabi</option>
                    <option value="Whole Year">Whole Year</option>
                    <option value="Summer">Summer</option>
                    <option value="Autumn">Autumn</option>
                    <option value="Winter">Winter</option>
                </select>
            </div>
            <div>
                <label for="district" class="block text-gray-700 text-sm font-semibold mb-2">District (e.g., Pune)</label>
                <input type="text" id="district" value="Pune" class="shadow-sm focus:ring-indigo-500 focus:border-indigo-500 block w-full sm:text-sm border-gray-300 rounded-md">
            </div>
        </div>
        <div class="flex justify-center mb-10">
            <button onclick="getPredictions()">Predict Crops</button>
        </div>
        <div id="loading" class="text-center text-indigo-600 font-medium hidden">
            <svg class="animate-spin h-5 w-5 mr-3 inline-block" viewBox="0 0 24 24">
                <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
            </svg>
            Predicting...
        </div>
        <div id="error-message" class="text-center text-red-600 font-medium hidden mb-4"></div>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div id="traditional-results" class="result-card hidden">
                <h2 class="text-xl font-semibold text-gray-800 mb-3">Top 3 Traditional Crops:</h2>
                <ul id="traditional-list" class="list-disc list-inside text-gray-700">
                    <!-- Predictions will be inserted here -->
                </ul>
            </div>
            <div id="exotic-results" class="result-card hidden">
                <h2 class="text-xl font-semibold text-gray-800 mb-3">Top 2 Exotic Crops:</h2>
                <ul id="exotic-list" class="list-disc list-inside text-gray-700">
                    <!-- Suggestions will be inserted here -->
                </ul>
            </div>
        </div>
    </div>
    <script>
        async function getPredictions() {
            const month = document.getElementById('month').value;
            const season = document.getElementById('season').value;
            const district = document.getElementById('district').value;
            const loadingDiv = document.getElementById('loading');
            const errorDiv = document.getElementById('error-message');
            const traditionalResultsDiv = document.getElementById('traditional-results');
            const exoticResultsDiv = document.getElementById('exotic-results');
            const traditionalList = document.getElementById('traditional-list');
            const exoticList = document.getElementById('exotic-list');
            // Clear previous results and errors
            errorDiv.classList.add('hidden');
            traditionalResultsDiv.classList.add('hidden');
            exoticResultsDiv.classList.add('hidden');
            traditionalList.innerHTML = '';
            exoticList.innerHTML = '';
            // Basic input validation
            if (!month || month < 1 || month > 12 || !season || !district) {
                errorDiv.textContent = 'Please fill in all input fields with valid values.';
                errorDiv.classList.remove('hidden');
                return;
            }
            loadingDiv.classList.remove('hidden');
            try {
                // --- This is the key change: calling your Flask backend API ---
                const response = await fetch('http://localhost:5000/predict_crops', { // IMPORTANT: Ensure this URL matches your Flask server's address and port
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ month, season, district }),
                });
                if (!response.ok) {
                    const errorData = await response.json(); // Assuming backend sends JSON error
                    throw new Error(errorData.error || `Server error: ${response.status}`);
                }
                const data = await response.json();
                const top3Traditional = data.traditional_crops;
                const top2Exotic = data.exotic_crops;
                // --- END OF BACKEND API CALL ---
                // Display traditional crops
                if (top3Traditional && top3Traditional.length > 0) {
                    top3Traditional.forEach(crop => {
                        const li = document.createElement('li');
                        li.textContent = `${crop.name} (Probability: ${crop.probability.toFixed(2)})`;
                        traditionalList.appendChild(li);
                    });
                    traditionalResultsDiv.classList.remove('hidden');
                } else {
                    traditionalList.innerHTML = '<li>No traditional crop predictions available.</li>';
                    traditionalResultsDiv.classList.remove('hidden');
                }
                // Display exotic crops
                if (top2Exotic && top2Exotic.length > 0) {
                    top2Exotic.forEach(crop => {
                        const li = document.createElement('li');
                        li.textContent = crop;
                        exoticList.appendChild(li);
                    });
                    exoticResultsDiv.classList.remove('hidden');
                } else {
                    exoticList.innerHTML = '<li>No exotic crop suggestions available.</li>';
                    exoticResultsDiv.classList.remove('hidden');
                }
            } catch (error) {
                console.error('Prediction error:', error);
                errorDiv.textContent = `Error getting predictions: ${error.message}. Please ensure the backend server is running and accessible.`;
                errorDiv.classList.remove('hidden');
            } finally {
                loadingDiv.classList.add('hidden');
            }
        }
    </script>
</body>
</html>
